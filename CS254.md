# CS254 Algorithmic Graph Theory

## Week 1 - lecture 1



Key points

- understanding basic properties of graphics and design efficient algorithms
- Designing efficient algorithms for graph problems
- Analysing algorithms and proving correctness

Motivated typically by IT/CS

Running and correctness to determine the quality of the algorithms

### Introduction

#### Basic definitions

Graph definitions (according to module)

Graph:

- A pair of vertices and edges $G=(V,E)$
  - V are vertices / nodes
  - E are pairwise relations of elements of V
- Undir graph $G=(V,E)$  (typically this is the type which will be looked at)
  - V are vertices
  - E are edges - a set of sets of pairs of edges
- di Graphs - simple
  - V a set of vertices
  - $E\subseteq V \cross V$ edges, where E is non - reflexive
- Undir multigraph - pseudograph
  - A set of V vertices
  - A multi set E of edges that consist of two-element multi-sets over elements V
- Directed multigraph
  - The same as a digraph, but allows multiple elements
  - $E\subseteq V\cross V$ -
    - Terminology - sometimes an edge is an arc
- Order of a graph
  - The cardinality of the vertex set, usually use $n$ to denote $|V|$
- The size of a graph is the cardinality $|E$| of its edge set
- A graph that does not contain , multi edges or self loop is called simple

- An edge $e$ is incident to a vertex $v$ if:
  - $v\in e$ for undirected graphs
  - $e=(v,x)$ or $e-(v,x)$ with $x\in V$ 
- The two vertices an edge e is incident to are called the end points of e
- Two vertices u and v are adjacent if there is an edge e that is inciden to both of them
- Two edges are called adjacent if they share some commone vertex
- For a digraph, $u$ is called the tail and v s called the head
- The degree is the number of edges incident to it
  - Self loop is counted twice
- Inand out degreee in a digraph
- $deg(vv) = indeg(v) + outdeg(v)$
- $\sum_{v\in V} deg(v)=2E$

- $\Delta$ is denoted for the maximum degree of a graph
- A sequence is called a path if:
  - $\forall i \in \{1,…,k-1\}:\{v_j, v_{i + 1}\}\in E$
- The length is the number of its edges
- A path is called a cycle if it has the same start and end point
- Is simple if al; vertices are distinct
- A cycle is simple if the vertices are distinct  - bar the start and finish
- A cycle of odd(even) length is called an odd(even) cycle

Graph connection

- Call a undir graph G connected if there exists a u,v path for ever pair of vertices u and v
- We call a digraph G connected if for ever pair for vertices u,v there exists either a u v path or a  v u path
- Call a digraph strongly connected if for every pair of vertices u,v there exists a u,v path and a v, u path

Subgraph terminology

- A subgraph if the edges and nodes are a subset of the original graphs
- Induced subgraph of $G$ if it is a subgraph of $G$ and $E’$ contains all edges of $E$ with end points in $V’$ 
- A subgraph of $G’=(V’,E)$ of a graph $G=(V,E)$ is called spanning if $V’ = V$

- undir graph that does not contain a cycle as a subgraph is a forest
- An undir graph, connected graph that does not contain a cycle as a subgraph is called a tree
- A spanning subgraph of a graph $G$ that is a tree called a spanning tree of $G$

DAG

- a directed graph that does not contain a cycle is called a DAG
- Has a maximum of $\frac{n(n-1)}{2}$ 
- $V=\{1,…,n\}$
- $E=\{(i,j), i <j\}$

Bipartite graphs

- An undir graph $G=(V,E)$ is called bipartite if the set $V$ can be decomposed into subset $V_1,V_2$ such that
- $V=V_1\uplus V_2$

### Testing Bipartiteness

Is there a partition of $V$ into two set $V_1$ and $V_2$ such that $V_1,V_2$ are independent sets

- WLOG add the first node into $V_1$ 

Use a two colouring 

- The second must be in $V_1$

#### Corollary

A graph that contains an odd cycle is not bipartite

- A graph is not bipartite iff G contains an odd cycle



### BFS and Bipartiteness

P1 - Edges not contains in the BFS tree can only connect successive layers or may connect nodes on the same layer

P2 - The BFS tree contains a shortest (s,v) path for every node v reachable from s

- Run  BFS and analyse the structure of the explored graphs
- Consider only connected graphs

**Lemma**

G is bipartite iff there is no edge u,v with u and v on the same level in the BFS tree

A graph is bipartite iff it does not contain an odd length cycle

**P2 Shortest path property**

- The nodes are added to the BFS tree in non-decreasing order of distance to s

![image-20220117132235873](C:\Users\leonc\AppData\Roaming\Typora\typora-user-images\image-20220117132235873.png)



- By the prooof above, we know that nodes are added to T in non-decreasing order
- Proof by cont:
  - Assume that v is the node closest to s in G for which no shortes s,v path is contained in T]
- Let u denote the predecessor of v in some shortes s,v path and let x denote the predecessor of v in T
- Then some shortest s,u path will be contained in 

![image-20220118160925868](C:\Users\leonc\AppData\Roaming\Typora\typora-user-images\image-20220118160925868.png)

**P1 Proof**

- $\{u,v\}\in E$ so that u is on layer l, v is at layer l'. $l<l' - 1$
- $dist(s,v) = l' - 1, dist(s,u) = l$
  - $l + 1 \geq l'$
  - Contradiction

## Graph Representation

- BFS algorithm runs in time $O(n+m)$ to determine if an undirected graph is bi partite, if the graph is represented by adjacency lists

### Adjacency list advantages

- Go thorugh all vertices in $O(n)$ time
- For every vertex $v$ we can go through all neighbours of $v$ time $O(d(v))$
- Checking if $(u,v)\in E$ requires $\Theta(min\{d(v),d(u)\})$
- Topological sort can be done in O(m+n)

### Adjacency Matrix Advantages

- Go through all list of vertices in $O(n)$
- Checking if an edge, can take $O(1)$ time



### Problem

- Simple digraph $G=(V,e)$ a vertex $u\in V$ is a sink if:
  - In $deg(u)=n-1$
  - out $deg(u)=0$
- Given a simple digraph $G=(V,e)$ one can find all its sinks in time $O(n)$

**Claim** no simple digraph has more than one sink

Suppose G has two or more sinks

- Let $u,v\in V$ be two sinks
- Since u is a sink, $indeg(u)=n-1$ and $outdeg(u) = 0$
- Means that $(u,v)\notin E$

**Algorithm**

Check u,v $\in E$

- This will tell us that there is at least one of $u,v$ is not the sink
- If $uv \in E$ then u is not a sink, 
- If $u,v \notin E$ then v is not a sink,
- After $n-1$ tests, there will be only one vertex surviving.
  - Cannot know if it is a sink
  - Check every vertex $v\in V$
    - $(u,v)\notin E$ and $(v,u)\in E$
    - If this is the case, then $u$ is the sink - otherwise $u$ is not the sink 

A total of $3(n-1)$ accesses

### Bipartiteness and BFS and ADJ Mat

- Any algorithm that determines if a graph is bipartite that has an input a undirected graph $G=(V,E)$ is bipartite that has as its input a undirected graph $G=(V,E)$ represented as an $n\cross n$ adj matrix, has the running time $\Omega(n^2)$

The lower bound for sorting integers that are only done by comparison is:

- $\Omega(n$ $log$ $n)$

**Proof**

- Pick any algorithm ALG for determining bipartiteness
- For a given arbitrary graph $G=(V,E)$ represented as $n\cross n$ adj matrix A, algorithm ALG
  - Either returns TRUE
  - or Returns FALSE
- Show that ALG must have run time $\Omega(n^2)$
- Consider the behaviour of the ALG on a star graph $G_0=(V,E_0)$ with $V=\{1,2,...,n\}$ and $E_0=\{\{1,i\}:2\leq i \leq n\}$
- In each step of its computation algorithm ALG either accesses an entry in the adj matrix A or does some other computation
- Suppose that for $G_0=(V,E)$ algorithm ALG accesses exactly $L$ entries in the ADJ mat
- $L$ is the lower bound for the running time of ALG

$L=\Omega(n^2)$

For given algorithm ALG construct G1 st:

- If alg performs less than $\frac{n-1}{2}$ accesses to the adj matrix of A of G0
- G1 is not bipartite

Since G0 is bipartite, G1 is not bipartite, and ALG cannot distinguish between G0 and G1, then ALG fails

- Since $L< N\C2$ 
- There must be a pair of vertices $i,j\in V,2\leq i<j \leq n$ such that ALG neither accesses the entry A[i,j] or A[j,i]
- This means there is at least one element which wasn't queried
- ALG outputs the outcome TRUE for the sta without accessing the other entries
- ALG will output the same output for the same output TRUE for the graph
- This is a contradiction since G1 is not bipartite and hence must be different for G0 and G1
- Hence we must have $L\leq N\C2$
- Implies algorithm has time $\Omega(n^2)$

#### BFS running time

- The running time is $O(n^2)$
- 























